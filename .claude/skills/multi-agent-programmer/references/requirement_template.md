# 需求分析文档模板

本文档由 Requirements Agent 生成，用于指导 Code Agent 进行代码实现。

---

## 文档元数据

| 字段 | 值 |
|------|-----|
| **需求ID** | REQ-YYYYMMDD-001 |
| **创建时间** | YYYY-MM-DD HH:MM |
| **创建代理** | Requirements Agent |
| **状态** | Draft / Approved |

---

## 1. 需求概述

### 1.1 背景说明
[描述为什么需要这个功能/改动]

### 1.2 目标陈述
[简明扼要地说明要达成的目标，使用用户故事格式：作为[角色]，我想要[功能]，以便[目的]]

### 1.3 成功标准
[列出可衡量的成功条件]

---

## 2. 功能需求

### 2.1 核心功能

| 功能点 | 描述 | 优先级 |
|--------|------|--------|
| 功能1 | [详细描述] | P0 / P1 / P2 |
| 功能2 | [详细描述] | P0 / P1 / P2 |

### 2.2 用户交互流程
```
[使用 ASCII 或文字描述交互流程]
用户 → [操作] → 系统 → [响应] → 用户
```

### 2.3 输入输出规格

**输入：**
- `parameter1`: 类型 - 描述 - 约束条件
- `parameter2`: 类型 - 描述 - 约束条件

**输出：**
- 返回值：类型 - 描述
- 副作用：描述（如文件修改、状态变更等）

---

## 3. 非功能需求

### 3.1 性能要求
- 响应时间：<X 秒
- 吞吐量：> X 次/秒
- 并发支持：> X 个并发请求

### 3.2 安全要求
- 认证要求：[描述需要的认证方式]
- 授权检查：[描述权限验证逻辑]
- 数据保护：[敏感数据处理方式]

### 3.3 可用性要求
- 错误处理：[错误提示方式]
- 日志记录：[需要记录的关键操作]

---

## 4. 技术约束

### 4.1 技术栈
- 编程语言：[Python / JavaScript / 其他]
- 框架/库：[列出相关依赖]
- 数据存储：[数据库/文件系统]

### 4.2 兼容性
- 支持的平台：[操作系统/环境]
- 向后兼容：[是否需要保持兼容]

### 4.3 依赖项
- 外部服务：[API / 服务依赖]
- 内部模块：[需要调用的其他模块]

---

## 5. 实现指导

### 5.1 代码组织
```
[建议的文件/目录结构]
project/
├── module1/
│   └── feature.py
└── module2/
    └── helper.py
```

### 5.2 关键接口/类

```python
# 代码示例：接口定义
class FeatureInterface:
    def process(self, input: InputType) -> OutputType:
        """处理逻辑"""
        pass
```

### 5.3 设计模式建议
- [推荐使用的设计模式]
- [避免的反模式]

---

## 6. 边界情况与错误处理

### 6.1 边界情况清单

| 场景 | 预期行为 | 优先级 |
|------|----------|--------|
| 空输入 | [描述处理方式] | P0 |
| 超长输入 | [描述处理方式] | P1 |
| 并发操作 | [描述处理方式] | P2 |

### 6.2 错误处理规范

```python
# 错误处理示例
try:
    result = process(input)
except ValidationError as e:
    # 返回用户友好的错误信息
    return {"error": f"输入验证失败: {e}"}
except ExternalServiceError as e:
    # 记录日志，返回降级响应
    logger.error(f"外部服务错误: {e}")
    return {"error": "服务暂时不可用，请稍后重试"}
```

### 6.3 异常分类
- **用户错误**：输入验证失败、权限不足 → 返回 400/403
- **系统错误**：数据库连接失败、超时 → 返回 500，记录日志
- **业务错误**：业务规则冲突 → 返回 422，说明原因

---

## 7. 测试验收标准

### 7.1 单元测试要求
- 核心逻辑覆盖率：> 90%
- 边界情况测试：[列出必须测试的场景]

### 7.2 集成测试场景
1. 正常流程测试：[描述测试步骤和预期结果]
2. 异常流程测试：[描述测试步骤和预期结果]

### 7.3 验收检查点

- [ ] 功能完整性：所有核心功能正常工作
- [ ] 错误处理：所有错误情况有适当处理
- [ ] 性能达标：满足性能要求
- [ ] 安全合规：通过安全检查
- [ ] 代码质量：符合编码规范

---

## 8. 风险与注意事项

### 8.1 技术风险
| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| [风险描述] | 高/中/低 | [缓解方案] |

### 8.2 实现注意事项
- [需要特别小心的地方]
- [容易出错的环节]
- [性能敏感的代码段]

---

## 9. 相关资源

### 9.1 参考文档
- [API文档链接]
- [设计文档链接]
- [相关代码位置]

### 9.2 类似实现
- [可参考的现有代码]
- [外部资源/示例]

---

## 10. 附录

### 10.1 术语表
| 术语 | 定义 |
|------|------|
| [术语] | [解释] |

### 10.2 变更历史
| 版本 | 日期 | 变更内容 | 变更人 |
|------|------|----------|--------|
| 1.0 | YYYY-MM-DD | 初始版本 | Requirements Agent |

---

*Requirements Agent 注意事项：*
1. 尽可能详细和结构化，减少 Code Agent 的猜测
2. 对于不确定的地方，在文档中明确标注 "需要确认"
3. 优先级标注要准确，P0 表示必须实现，P2 表示可选
4. 验收标准必须可验证和可测试
