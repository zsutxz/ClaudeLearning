# <!-- 由 BMAD™ Core 提供支持 -->
template:
  id: prd-template-v2
  name: 产品需求文档
  version: 2.0
  output:
    format: markdown
    filename: docs/prd.md
    title: "{{project_name}} 产品需求文档 (PRD)"

workflow:
  mode: 交互式
  elicitation: 高级启发式

sections:
  - id: goals-context
    title: 目标和背景上下文
    instruction: |
      询问是否有项目简报文档。如果没有项目简报，则强烈建议首先使用project-brief-tmpl创建一个（它提供了必要的基础：问题陈述、目标用户、成功指标、MVP范围、约束条件）。如果用户坚持在没有简报的情况下创建PRD，则在目标部分收集这些信息。如果存在项目简报，请审查并使用它来填充目标（期望结果的要点列表）和背景上下文（1-2段关于此解决方案及其原因），以便我们可以确定PRD mvp的范围。无论如何，这对于确定需求都至关重要。包含变更日志表。
    sections:
      - id: goals
        title: 目标
        type: bullet-list
        instruction: 如果PRD成功交付，期望结果的1行要点列表 - 用户和项目需求
      - id: background
        title: 背景上下文
        type: paragraphs
        instruction: 1-2段简短段落，总结背景上下文，例如我们在简报中学到的内容，而不与目标重复，这个解决了什么问题以及为什么解决，当前的情况或需求是什么
      - id: changelog
        title: 变更日志
        type: table
        columns: [日期, 版本, 描述, 作者]
        instruction: 跟踪文档版本和变更

  - id: requirements
    title: 需求
    instruction: 起草功能性和非功能性需求列表在两个子部分下
    elicit: true
    sections:
      - id: functional
        title: 功能性
        type: numbered-list
        prefix: FR
        instruction: 每个需求将是一个markdown要点和以FR开头的标识符序列
        examples:
          - "FR6: 待办事项列表使用AI检测并警告措辞不同的潜在重复待办事项。"
      - id: non-functional
        title: 非功能性
        type: numbered-list
        prefix: NFR
        instruction: 每个需求将是一个markdown要点和以NFR开头的标识符序列
        examples:
          - "NFR1: AWS服务使用必须在可行的情况下保持在免费层限制内。"

  - id: ui-goals
    title: 用户界面设计目标
    condition: PRD有UX/UI需求
    instruction: |
      捕获高层次的UI/UX愿景以指导设计架构师并通知故事创建。步骤：

      1. 根据项目上下文用有根据的猜测预填充所有子部分
      2. 向用户呈现完整的渲染部分
      3. 明确让用户知道在哪里做了假设
      4. 对于不清楚/缺失的元素或需要更多规范的领域提出有针对性的问题
      5. 这不是详细的UI规范 - 专注于产品愿景和用户目标
    elicit: true
    choices:
      accessibility: [无, WCAG AA, WCAG AAA]
      platforms: [响应式Web, 仅移动设备, 仅桌面设备, 跨平台]
    sections:
      - id: ux-vision
        title: 整体UX愿景
      - id: interaction-paradigms
        title: 关键交互范式
      - id: core-screens
        title: 核心屏幕和视图
        instruction: 从产品角度来看，什么是交付PRD价值和目标所需的关键屏幕或视图？这是概念性的高层描述，用于驱动大致的史诗或用户故事
        examples:
          - "登录屏幕"
          - "主仪表板"
          - "项目详情页"
          - "设置页面"
      - id: accessibility
        title: "可访问性: {无|WCAG AA|WCAG AAA|自定义需求}"
      - id: branding
        title: 品牌形象
        instruction: 有任何必须包含的已知品牌形象元素或样式指南吗？
        examples:
          - "复制早期1900年代黑白电影的外观和感觉，包括在页面或状态转换期间复制胶片损坏或放映机故障的动画效果。"
          - "附件是我们企业品牌的完整调色板和令牌。"
      - id: target-platforms
        title: "目标设备和平台: {响应式Web|仅移动设备|仅桌面设备|跨平台}"
        examples:
          - "响应式Web，以及所有移动平台"
          - "仅iPhone"
          - "ASCII Windows桌面"

  - id: technical-assumptions
    title: 技术假设
    instruction: |
      收集将指导架构师的技术决策。步骤：

      1. 检查.bmad-core/data/technical-preferences.yaml或附加的技术偏好文件是否存在 - 使用它来预填充选择
      2. 询问用户关于：语言、框架、启动模板、库、API、部署目标
      3. 对于未知项，根据项目目标和MVP范围提供指导
      4. 记录所有技术选择及其理由（为什么这个选择适合项目）
      5. 这些成为架构师的约束条件 - 要具体和完整
    elicit: true
    choices:
      repository: [单体库, 多库]
      architecture: [单体, 微服务, 无服务器]
      testing: [仅单元测试, 单元+集成测试, 完整测试金字塔]
    sections:
      - id: repository-structure
        title: "仓库结构: {单体库|多库|多仓库}"
      - id: service-architecture
        title: 服务架构
        instruction: "关键决策 - 记录高层服务架构（例如，单体、微服务、单体库内的无服务器函数）。"
      - id: testing-requirements
        title: 测试需求
        instruction: "关键决策 - 记录测试需求，仅单元测试、集成测试、端到端测试、手动测试、手动测试便利方法的需求。"
      - id: additional-assumptions
        title: 其他技术假设和请求
        instruction: 在整个起草此文档的过程中，如果发现任何其他适合架构师的技术假设，请在此处作为额外的要点项目添加

  - id: epic-list
    title: 史诗列表
    instruction: |
      呈现高层次的所有史诗列表供用户批准。每个史诗都应该有一个标题和一个简短的（1句话）目标陈述。这允许用户在深入细节之前审查整体结构。

      关键：史诗必须按照敏捷最佳实践逻辑顺序排列：

      - 每个史诗都应该交付一个重要的、端到端的、完全可部署的可测试功能增量
      - 史诗1必须建立基础项目基础设施（应用程序设置、Git、CI/CD、核心服务），除非我们是在现有应用程序中添加新功能，同时交付初始功能，即使是一个健康检查路由或显示简单金丝雀页面 - 在我们为第一个史诗制作故事时记住这一点！
      - 每个后续史诗都在之前史诗功能的基础上构建，交付为用户或业务提供有形价值的主要功能块
      - 不是每个项目都需要多个史诗，一个史诗需要交付价值。例如，一个完成的API可以交付价值，即使UI不完整并计划在单独的史诗中。
      - 宁可少一些史诗，但要让用户知道你的理由，并在某些史诗太大或关注不同事物时提供拆分选项。
      - 跨领域关注点应该贯穿史诗和故事，而不是最终的故事。例如，在史诗末尾或项目结束时作为最终史诗或故事添加日志框架将是糟糕的，因为我们从一开始就没有日志。
    elicit: true
    examples:
      - "史诗1：基础和核心基础设施：建立项目设置、身份验证和基本用户管理"
      - "史诗2：核心业务实体：创建和管理具有CRUD操作的主要领域对象"
      - "史诗3：用户工作流和交互：启用关键用户旅程和业务流程"
      - "史诗4：报告和分析：为用户提供洞察和数据可视化"

  - id: epic-details
    title: 史诗 {{epic_number}} {{epic_title}}
    repeatable: true
    instruction: |
      史诗列表获得批准后，呈现每个史诗及其所有故事和验收标准作为一个完整的审查单元。

      对于每个史诗提供扩展目标（2-3句话描述所有故事将实现的目标和价值）。

      关键故事排序要求：

      - 每个史诗内的故事必须逻辑顺序排列
      - 每个故事应该是一个"垂直切片"，交付完整功能，除了早期的项目基础启用器故事
      - 没有故事应该依赖于后续故事或史诗的工作
      - 识别并注明任何直接的先决条件故事
      - 专注于"什么"和"为什么"而不是"如何"（将技术实现留给架构师），但要足够精确以支持从故事到故事的逻辑顺序操作
      - 确保每个故事都交付明确的用户或业务价值，尽量避免启用器，将它们构建到交付价值的故事中
      - 为AI代理执行调整故事大小：每个故事必须能够由单个AI代理在一次专注会话中完成，而不会出现上下文溢出
      - 想象"初级开发人员工作2-4小时" - 故事必须小、专注和自包含
      - 如果一个故事看起来复杂，请进一步分解，只要它能交付垂直切片
    elicit: true
    template: "{{epic_goal}}"
    sections:
      - id: story
        title: 故事 {{epic_number}}.{{story_number}} {{story_title}}
        repeatable: true
        template: |
          作为一个 {{user_type}},
          我想要 {{action}},
          以便 {{benefit}}.
        sections:
          - id: acceptance-criteria
            title: 验收标准
            type: numbered-list
            item_template: "{{criterion_number}}: {{criteria}}"
            repeatable: true
            instruction: |
              定义清晰、全面和可测试的验收标准：

              - 精确定义从功能角度来说"完成"意味着什么
              - 明确无歧义，可作为验证基础
              - 包括PRD中的任何关键非功能性需求
              - 考虑后端/数据组件的本地可测试性
              - 指定UI/UX需求和框架遵循情况（如适用）
              - 避免应在其他故事或PRD部分中的跨领域关注点

  - id: checklist-results
    title: 检查清单结果报告
    instruction: 在运行检查清单和起草提示之前，提供输出完整更新的PRD的选项。如果要输出，请确认您将继续运行检查清单并生成报告。用户确认后，执行pm-checklist并在本节中填充结果。

  - id: next-steps
    title: 下一步
    sections:
      - id: ux-expert-prompt
        title: UX专家提示
        instruction: 本节将包含UX专家的提示，保持简短扼要以使用本文档作为输入启动创建架构模式。
      - id: architect-prompt
        title: 架构师提示
        instruction: 本节将包含架构师的提示，保持简短扼要以使用本文档作为输入启动创建架构模式。