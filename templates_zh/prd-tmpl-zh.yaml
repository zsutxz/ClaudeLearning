# <!-- 由BMAD™ Core提供支持 -->
template:
  id: prd-template-v2
  name: 产品需求文档
  version: 2.0
  output:
    format: markdown
    filename: docs/prd.md
    title: "{{project_name}} 产品需求文档 (PRD)"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

sections:
  - id: goals-context
    title: 目标和背景上下文
    instruction: |
      询问项目简报文档是否可用。如果没有项目简报，强烈建议首先使用project-brief-tmpl创建一个（它提供了必要的基础：问题陈述、目标用户、成功指标、MVP范围、约束）。如果用户坚持在没有简报的情况下创建PRD，请在目标部分收集此信息。如果项目简报存在，请查看并使用它来填充目标（期望结果的要点列表）和背景上下文（1-2段关于解决什么问题以及为什么），以便我们可以确定PRD mvp的范围。无论如何，这对确定需求都是至关重要的。包括变更日志表。
    sections:
      - id: goals
        title: 目标
        type: bullet-list
        instruction: 期望结果的要点列表 - 用户和项目需求
      - id: background
        title: 背景上下文
        type: paragraphs
        instruction: 1-2段简短段落，总结背景上下文，例如我们在简报中了解到的内容，而不与目标重复，解决了什么问题以及为什么
      - id: changelog
        title: 变更日志
        type: table
        columns: [日期, 版本, 描述, 作者]
        instruction: 跟踪文档版本和变更

  - id: requirements
    title: 需求
    instruction: 起草功能性和非功能性需求列表在两个子节下
    elicit: true
    sections:
      - id: functional
        title: 功能性
        type: numbered-list
        prefix: FR
        instruction: 每个需求将是一个要点markdown和从FR开始的标识符序列
        examples:
          - "FR6: 待办事项列表使用AI检测并警告措辞不同但可能重复的待办事项。"
      - id: non-functional
        title: 非功能性
        type: numbered-list
        prefix: NFR
        instruction: 每个需求将是一个要点markdown和从NFR开始的标识符序列
        examples:
          - "NFR1: AWS服务使用必须在可行的情况下保持在免费层限制内。"

  - id: ui-goals
    title: 用户界面设计目标
    condition: PRD有UX/UI需求
    instruction: |
      捕获高级UI/UX愿景以指导设计架构师并通知故事创建。步骤：

      1. 基于项目上下文用有根据的猜测预填充所有子节
      2. 将完整的渲染部分呈现给用户
      3. 明确让用户知道在哪里做出了假设
      4. 对不清楚/缺失的元素或需要更多规范的领域提出有针对性的问题
      5. 这不是详细的UI规范 - 专注于产品愿景和用户目标
    elicit: true
    choices:
      accessibility: [无, WCAG AA, WCAG AAA]
      platforms: [Web响应式, 仅移动, 仅桌面, 跨平台]
    sections:
      - id: ux-vision
        title: 整体UX愿景
      - id: interaction-paradigms
        title: 关键交互范式
      - id: core-screens
        title: 核心屏幕和视图
        instruction: 从产品角度来看，哪些是交付PRD值和目标所需的关键屏幕或视图？这是概念性的高级内容，用于驱动大致的史诗或用户故事
        examples:
          - "登录屏幕"
          - "主仪表板"
          - "项目详情页"
          - "设置页面"
      - id: accessibility
        title: "可访问性: {无|WCAG AA|WCAG AAA|自定义需求}"
      - id: branding
        title: 品牌
        instruction: 是否有任何必须纳入的已知品牌元素或样式指南？
        examples:
          - "复制早期1900年代黑白电影的外观和感觉，包括在页面或状态转换期间复制电影损坏或放映机故障的动画效果。"
          - "附件是我们公司品牌完整的调色板和令牌。"
      - id: target-platforms
        title: "目标设备和平台: {Web响应式|仅移动|仅桌面|跨平台}"
        examples:
          - "Web响应式，以及所有移动平台"
          - "仅iPhone"
          - "ASCII Windows桌面"

  - id: technical-assumptions
    title: 技术假设
    instruction: |
      收集将指导架构师的技术决策。步骤：

      1. 检查.bmad-core/data/technical-preferences.yaml或附加的技术偏好文件是否存在 - 使用它来预填充选择
      2. 询问用户：语言、框架、启动模板、库、API、部署目标
      3. 对于未知项，基于项目目标和MVP范围提供指导
      4. 记录所有技术选择及其理由（为什么这个选择适合项目）
      5. 这些成为架构师的约束 - 要具体和完整
    elicit: true
    choices:
      repository: [Monorepo, Polyrepo]
      architecture: [单体, 微服务, 无服务器]
      testing: [仅单元, 单元+集成, 完整测试金字塔]
    sections:
      - id: repository-structure
        title: "仓库结构: {Monorepo|Polyrepo|多仓库}"
      - id: service-architecture
        title: 服务架构
        instruction: "关键决策 - 记录高级服务架构（例如，单体、微服务、Monorepo中的无服务器函数）。"
      - id: testing-requirements
        title: 测试要求
        instruction: "关键决策 - 记录测试要求，仅单元、集成、端到端、手动、需要手动测试便利方法）。"
      - id: additional-assumptions
        title: 其他技术假设和请求
        instruction: 在整个起草此文档的过程中，如果提出了任何其他适合架构师的技术假设或发现，请将它们作为额外的要点项目添加到这里

  - id: epic-list
    title: 史诗列表
    instruction: |
      呈现所有史诗的高级列表供用户批准。每个史诗都应该有一个标题和一个简短（1句话）的目标声明。这允许用户在深入细节之前审查整体结构。

      关键：史诗必须按照敏捷最佳实践逻辑顺序：

      - 每个史诗应该交付一个重要的、端到端的、完全可部署的可测试功能增量
      - 史诗1必须建立基础项目基础设施（应用程序设置、Git、CI/CD、核心服务），除非我们在向现有应用程序添加新功能，同时还要交付一个初始功能片段，即使是一个简单的健康检查路由或显示简单金丝雀页面 - 在我们为第一个史诗制作故事时记住这一点！
      - 每个后续史诗在之前史诗功能的基础上构建，交付主要的功能块，为用户或业务提供有形价值
      - 并非每个项目都需要多个史诗，一个史诗需要交付价值。例如，一个完成的API即使UI不完整并且计划在单独的史诗中也可以交付价值。
      - 跨领域关注点应该流经史诗和故事，而不是最终的故事。例如，在史诗的最后故事中添加日志框架，或在项目结束时作为最终史诗或故事添加日志框架将是糟糕的，因为从一开始我们就不会有日志。
    elicit: true
    examples:
      - "史诗1: 基础和核心基础设施: 建立项目设置、身份验证和基本用户管理"
      - "史诗2: 核心业务实体: 创建和管理具有CRUD操作的主要域对象"
      - "史诗3: 用户工作流和交互: 启用关键用户旅程和业务流程"
      - "史诗4: 报告和分析: 为用户提供洞察和数据可视化"

  - id: epic-details
    title: 史诗 {{epic_number}} {{epic_title}}
    repeatable: true
    instruction: |
      史诗列表获得批准后，呈现每个史诗及其所有故事和验收标准作为一个完整的审查单元。

      对于每个史诗提供扩展目标（2-3句话描述目标和所有故事将实现的价值）。

      关键故事排序要求：

      - 史诗内的故事必须逻辑顺序
      - 每个故事应该是一个"垂直切片"，交付完整的功能，除了早期的项目基础故事
      - 没有故事应该依赖于后续故事或史诗的工作
      - 识别并注明任何直接的前提故事
      - 专注于"什么"和"为什么"而不是"如何"（将技术实现留给架构师），但要足够精确以支持从故事到故事的逻辑顺序操作
      - 确保每个故事交付清晰的用户或业务价值，尽量避免启用器并将其构建到能交付价值的故事中
      - 为AI代理执行调整故事大小：每个故事必须由单个AI代理在一个专注的会话中完成，无需上下文溢出
      - 想象"初级开发人员工作2-4小时" - 故事必须小、专注和自包含
      - 如果一个故事看起来复杂，请进一步分解，只要它能交付垂直切片
    elicit: true
    template: "{{epic_goal}}"
    sections:
      - id: story
        title: 故事 {{epic_number}}.{{story_number}} {{story_title}}
        repeatable: true
        template: |
          作为一个 {{user_type}},
          我想要 {{action}},
          以便 {{benefit}}.
        sections:
          - id: acceptance-criteria
            title: 验收标准
            type: numbered-list
            item_template: "{{criterion_number}}: {{criteria}}"
            repeatable: true
            instruction: |
              定义清晰、全面和可测试的验收标准：

              - 精确定义从功能角度来说"完成"意味着什么
              - 是明确的并作为验证的基础
              - 包括PRD中的任何关键非功能性要求
              - 考虑后端/数据组件的本地可测试性
              - 指定UI/UX要求和框架遵循情况（如适用）
              - 避免应该在其他故事或PRD部分中的跨领域关注点

  - id: checklist-results
    title: 检查清单结果报告
    instruction: 在运行检查清单和起草提示之前，提供输出完整更新的PRD的选项。如果输出它，与用户确认您将进行检查清单运行并生成报告。用户确认后，执行pm-checklist并在本节中填充结果。

  - id: next-steps
    title: 下一步
    sections:
      - id: ux-expert-prompt
        title: UX专家提示
        instruction: 本节将包含给UX专家的提示，保持简短和要点以启动创建架构模式使用此文档作为输入。
      - id: architect-prompt
        title: 架构师提示
        instruction: 本节将包含给架构师的提示，保持简短和要点以启动创建架构模式使用此文档作为输入。