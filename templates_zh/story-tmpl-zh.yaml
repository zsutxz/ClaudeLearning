# <!-- 由BMAD™ Core提供支持 -->
template:
  id: story-template-v2
  name: 故事文档
  version: 2.0
  output:
    format: markdown
    filename: docs/stories/{{epic_num}}.{{story_num}}.{{story_title_short}}.md
    title: "故事 {{epic_num}}.{{story_num}}: {{story_title_short}}"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

agent_config:
  editable_sections:
    - 状态
    - 故事
    - 验收标准
    - 任务 / 子任务
    - 开发笔记
    - 测试
    - 变更日志

sections:
  - id: status
    title: 状态
    type: choice
    choices: [草稿, 已批准, 进行中, 审查, 完成]
    instruction: 选择故事的当前状态
    owner: scrum-master
    editors: [scrum-master, dev-agent]

  - id: story
    title: 故事
    type: template-text
    template: |
      **作为一个** {{role}},
      **我想要** {{action}},
      **以便** {{benefit}}
    instruction: 使用标准格式定义用户故事，包括角色、行动和收益
    elicit: true
    owner: scrum-master
    editors: [scrum-master]

  - id: acceptance-criteria
    title: 验收标准
    type: numbered-list
    instruction: 从史诗文件中复制验收标准编号列表
    elicit: true
    owner: scrum-master
    editors: [scrum-master]

  - id: tasks-subtasks
    title: 任务 / 子任务
    type: bullet-list
    instruction: |
      将故事分解为实施所需的特定任务和子任务。
      在适用时引用相关的验收标准编号。
    template: |
      - [ ] 任务 1 (AC: # 如适用)
        - [ ] 子任务1.1...
      - [ ] 任务 2 (AC: # 如适用)
        - [ ] 子任务 2.1...
      - [ ] 任务 3 (AC: # 如适用)
        - [ ] 子任务 3.1...
    elicit: true
    owner: scrum-master
    editors: [scrum-master, dev-agent]

  - id: dev-notes
    title: 开发笔记
    instruction: |
      填充相关信息，仅从文档文件夹中的实际工件中提取的相关信息到这个故事：
      - 不要编造信息
      - 如果已知添加与此故事相关的相关源代码树信息
      - 如果有来自前一个故事的重要笔记与此故事相关，请包含在这里
      - 在本节中放入足够的信息，以便开发代理永远不需要阅读架构文档，这些笔记以及任务和子任务必须给开发代理提供完成故事所需的完整上下文，满足所有AC并完成所有任务+子任务
    elicit: true
    owner: scrum-master
    editors: [scrum-master]
    sections:
      - id: testing-standards
        title: 测试
        instruction: |
          列出开发人员需要遵守的架构中的相关测试标准：
          - 测试文件位置
          - 测试标准
          - 要使用的测试框架和模式
          - 此故事的任何特定测试要求
        elicit: true
        owner: scrum-master
        editors: [scrum-master]

  - id: change-log
    title: 变更日志
    type: table
    columns: [日期, 版本, 描述, 作者]
    instruction: 跟踪对此故事文档的变更
    owner: scrum-master
    editors: [scrum-master, dev-agent, qa-agent]

  - id: dev-agent-record
    title: 开发代理记录
    instruction: 此部分由开发代理在实施过程中填充
    owner: dev-agent
    editors: [dev-agent]
    sections:
      - id: agent-model
        title: 代理模型使用
        template: "{{agent_model_name_version}}"
        instruction: 记录用于开发的特定AI代理模型和版本
        owner: dev-agent
        editors: [dev-agent]

      - id: debug-log-references
        title: 调试日志引用
        instruction: 引用开发过程中生成的任何调试日志或跟踪
        owner: dev-agent
        editors: [dev-agent]

      - id: completion-notes
        title: 完成笔记列表
        instruction: 关于任务完成和遇到的任何问题的笔记
        owner: dev-agent
        editors: [dev-agent]

      - id: file-list
        title: 文件列表
        instruction: 列出在故事实施过程中创建、修改或影响的所有文件
        owner: dev-agent
        editors: [dev-agent]

  - id: qa-results
    title: QA结果
    instruction: QA代理对已完成故事实施的QA审查结果
    owner: qa-agent
    editors: [qa-agent]